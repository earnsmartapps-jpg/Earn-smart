<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Earn Smart Dashboard</title>

<style>
body{
margin:0;
font-family:Segoe UI;
background:linear-gradient(135deg,#0f172a,#1e293b,#0f172a);
color:white;
}
.container{max-width:900px;margin:auto;padding:20px;}
.card{
background:rgba(255,255,255,0.05);
padding:20px;
border-radius:15px;
margin-bottom:20px;
box-shadow:0 0 20px rgba(0,255,100,0.1);
}
button{
padding:10px 15px;
border:none;
border-radius:8px;
cursor:pointer;
font-weight:bold;
margin-top:8px;
}
.green{background:#22c55e;color:white;}
.blue{background:#3b82f6;color:white;}
input,select{
width:100%;
padding:10px;
margin:6px 0;
border-radius:8px;
border:none;
}
.wallet{
background:#111827;
padding:10px;
border-radius:8px;
word-break:break-all;
}
.hidden{display:none;}
</style>
</head>
<body>

<div class="container">

<h2>ðŸ’° Earn Smart Dashboard</h2>

<div class="card">
<h3>Email (Profile ID):</h3>
<div class="wallet" id="profileId">Loading...</div>
<h3>Balance: $<span id="balance">0.00</span></h3>
<h3>Earnings: $<span id="earnings">0.00</span></h3>
</div>

<div class="card">
<h3>Referral Link</h3>
<div class="wallet" id="refLink"></div>
</div>

<div class="card">
<h3>Select Investment Plan</h3>

<select id="plan">
<option value="">Select Plan</option>
<option value="starter">Starter - $5 (5% Daily)</option>
<option value="silver">Silver - $10 (5% Daily)</option>
<option value="diamond">Diamond - $20 (10% Daily)</option>
</select>

<select id="network">
<option value="">Select Network</option>
<option value="trc20">USDT TRC20</option>
<option value="bsc">BEP20 BSC</option>
<option value="erc20">ERC20 ETH</option>
</select>

<button class="blue" onclick="generateWallet()">Generate Deposit Address</button>

<div id="depositBox" class="hidden">
<div class="wallet" id="walletAddress"></div>
<p id="amountText"></p>
<input type="number" id="depositAmount" placeholder="Enter Amount Sent">
<button class="green" onclick="submitDeposit()">Submit Deposit</button>
</div>
</div>

<button onclick="logout()" class="blue">Logout</button>

</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, onAuthStateChanged, signOut }
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { getDatabase, ref, set, get, update, push, onValue }
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyAZP0UPvfCgiiir2zKLMae25dUpVcyP3iw",
  authDomain: "crypto-gainz-3524d.firebaseapp.com",
  databaseURL: "https://crypto-gainz-3524d-default-rtdb.firebaseio.com",
  projectId: "crypto-gainz-3524d",
  storageBucket: "crypto-gainz-3524d.firebasestorage.app",
  messagingSenderId: "270349829717",
  appId: "1:270349829717:web:6e3e2bf25f9ab60b2a76dc"
};

const app=initializeApp(firebaseConfig);
const auth=getAuth(app);
const db=getDatabase(app);

let currentUser;
let requiredAmount=0;
let selectedPlan="";

/* AUTH */
onAuthStateChanged(auth, async(user)=>{
if(!user){
location="index.html";
return;
}

/* BLOCK NON EMAIL USERS */
if(!user.email){
alert("Please login using Email & Password.");
signOut(auth);
location="index.html";
return;
}

currentUser=user;

/* SHOW EMAIL */
document.getElementById("profileId").innerText=user.email;
document.getElementById("refLink").innerText=
window.location.origin+"/?ref="+user.email;

/* CREATE USER RECORD */
const userRef=ref(db,"users/"+user.uid);
const snap=await get(userRef);

if(!snap.exists()){
await set(userRef,{
email:user.email,
balance:0,
earnings:0
});
}

/* LIVE UPDATE */
onValue(userRef,(snapshot)=>{
let data=snapshot.val();
document.getElementById("balance").innerText=(data.balance||0).toFixed(2);
document.getElementById("earnings").innerText=(data.earnings||0).toFixed(2);
});

});

/* GENERATE WALLET */
window.generateWallet=()=>{
selectedPlan=document.getElementById("plan").value;
let net=document.getElementById("network").value;

if(!selectedPlan||!net) return alert("Select plan & network");

if(selectedPlan==="starter") requiredAmount=5;
if(selectedPlan==="silver") requiredAmount=10;
if(selectedPlan==="diamond") requiredAmount=20;

let wallet="";
if(net==="trc20") wallet="TKJAvkyjdDSzKtS1HihiKno1tTfi2bTJJe";
if(net==="bsc") wallet="0xB66E1e0e5452489298bebd7Cd463587E6866baD2";
if(net==="erc20") wallet="0xB66E1e0e5452489298bebd7Cd463587E6866baD2";

document.getElementById("walletAddress").innerText=wallet;
document.getElementById("amountText").innerText="Send exactly $"+requiredAmount;
document.getElementById("depositBox").classList.remove("hidden");
};

/* SUBMIT DEPOSIT */
window.submitDeposit=async()=>{
let amt=parseFloat(document.getElementById("depositAmount").value);
if(amt!==requiredAmount) return alert("Incorrect amount");

await push(ref(db,"deposits"),{
uid:currentUser.uid,
email:currentUser.email,
amount:amt,
plan:selectedPlan,
status:"pending",
date:Date.now()
});

alert("Deposit submitted. Wait for admin approval.");
};

/* LOGOUT */
window.logout=()=>{
signOut(auth);
location="index.html";
};

</script>

</body>
  </html>
